$asw = [ApplicationSwitch.Switcher]::GetInstance()
$asw.EvacuateDirectory = "${env:USERPROFILE}\Downloads\Work"
$asw.HiddenEvacuateDirectory = $true

$ap = $asw.LoadRuleFile("${env:USERPROFILE}\Downloads\configs\test01.yml")

$ret = $ap.CheckMetadata()
if(!($ret)){ exit }

$ret = $ap.CheckTarget()
if(!($ret)){ exit }

$ret = $ap.CheckRule()
if(!($ret)){ exit }

$hostNameMatch = $ap.CheckEnableOrDisable()
